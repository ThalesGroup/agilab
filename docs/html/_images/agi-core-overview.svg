<svg xmlns="http://www.w3.org/2000/svg" width="900" height="380" viewBox="0 0 900 380" role="img" aria-labelledby="title desc">
  <title id="title">AGI core flow</title>
  <desc id="desc">Shows how Streamlit/CLI entrypoints call agi_core, which configures agi_env, orchestrates agi_cluster, and runs agi_node workers.</desc>
  <defs>
    <style>
      text { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; fill:#0f172a; }
      .box { stroke:#0f172a; stroke-width:2; rx:10; ry:10; }
      .caption { font-size:15px; font-weight:600; }
      .body { font-size:12px; }
    </style>
    <marker id="arrow" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L8,4 L0,8 z" fill="#0f172a" />
    </marker>
  </defs>

  <rect width="100%" height="100%" fill="#f8fafc" rx="18" ry="18" />
  <text class="caption" x="450" y="30" text-anchor="middle">AGI core orchestration</text>

  <!-- entrypoints -->
  <g transform="translate(40,70)">
    <rect class="box" width="200" height="80" fill="#bae6fd" />
    <text class="caption" x="100" y="26" text-anchor="middle">Streamlit UI</text>
    <text class="body" x="100" y="46" text-anchor="middle">AGILAB.py · apps-pages</text>
    <text class="body" x="100" y="62" text-anchor="middle">EXECUTE · EXPLORE · EDIT</text>
  </g>

  <g transform="translate(40,180)">
    <rect class="box" width="200" height="80" fill="#bae6fd" />
    <text class="caption" x="100" y="26" text-anchor="middle">CLI / PyCharm</text>
    <text class="body" x="100" y="46" text-anchor="middle">AGI_run_*.py · run configs</text>
    <text class="body" x="100" y="62" text-anchor="middle">uv run · uvx</text>
  </g>

  <!-- agi_core -->
  <g transform="translate(330,105)">
    <rect class="box" width="240" height="90" fill="#ddd6fe" />
    <text class="caption" x="120" y="26" text-anchor="middle">agi_core</text>
    <text class="body" x="120" y="48" text-anchor="middle">resolve app &amp; args · build run plan</text>
    <text class="body" x="120" y="64" text-anchor="middle">drive lab_steps · wire telemetry</text>
  </g>

  <!-- agi_env -->
  <g transform="translate(330,215)">
    <rect class="box" width="240" height="70" fill="#e0f2fe" />
    <text class="caption" x="120" y="26" text-anchor="middle">agi_env</text>
    <text class="body" x="120" y="46" text-anchor="middle">paths · configs · logging · share root</text>
  </g>

  <!-- agi_cluster -->
  <g transform="translate(330,305)">
    <rect class="box" width="240" height="70" fill="#c7f9cc" stroke="#0f172a" />
    <text class="caption" x="120" y="26" text-anchor="middle">agi_cluster</text>
    <text class="body" x="120" y="46" text-anchor="middle">AGI.distributor · scheduler · dask</text>
  </g>

  <!-- agi_node -->
  <g transform="translate(610,255)">
    <rect class="box" width="230" height="110" fill="#fde68a" />
    <text class="caption" x="115" y="26" text-anchor="middle">agi_node</text>
    <text class="body" x="115" y="48" text-anchor="middle">BaseWorker · DagWorker</text>
    <text class="body" x="115" y="64" text-anchor="middle">PandasWorker · PolarsWorker · FireducksWorker</text>
    <text class="body" x="115" y="80" text-anchor="middle">app-specific workers</text>
  </g>

  <!-- artefacts / telemetry -->
  <g transform="translate(610,90)">
    <rect class="box" width="230" height="100" fill="#fee2e2" />
    <text class="caption" x="115" y="26" text-anchor="middle">artefacts &amp; telemetry</text>
    <text class="body" x="115" y="48" text-anchor="middle">pipelines, parquet/csv outputs</text>
    <text class="body" x="115" y="64" text-anchor="middle">lab_steps history, logs</text>
    <text class="body" x="115" y="80" text-anchor="middle">shared under agi_env.share_root</text>
  </g>

  <!-- arrows -->
  <path d="M240,110 C300,110 300,120 330,140" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)" fill="none" />
  <path d="M240,220 C300,220 300,200 330,190" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)" fill="none" />
  <path d="M450,195 L450,215" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)" />
  <path d="M450,285 L450,305" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)" />
  <path d="M570,335 C600,335 600,320 610,320" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)" fill="none" />
  <path d="M570,250 C600,250 600,180 610,150" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)" fill="none" />
  <path d="M740,200 L740,255" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)" />
</svg>
